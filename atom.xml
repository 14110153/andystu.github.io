<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[AndyZ's Blog]]></title>
  <link href="http://andystu.github.io/atom.xml" rel="self"/>
  <link href="http://andystu.github.io/"/>
  <updated>2015-02-11T14:35:17+08:00</updated>
  <id>http://andystu.github.io/</id>
  <author>
    <name><![CDATA[Yu-Chieh Chang (張又介)]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Make Your Url Friendly for SEO/search Engine via Friendly Id and Babosa Gems]]></title>
    <link href="http://andystu.github.io/blog/2015/02/07/make-your-url-friendly-for-seo-slash-search-engine-via-friendly-id-and-babosa-gems/"/>
    <updated>2015-02-07T21:07:46+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/07/make-your-url-friendly-for-seo-slash-search-engine-via-friendly-id-and-babosa-gems</id>
    <content type="html"><![CDATA[<h3>If we want add more info with ID in URL for specific instance of model, the easy way is to override the to_param method.</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Model</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_params</span>
</span><span class='line'>    <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">parameterize</span> <span class="c1">#</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>However, we still need the ID at the start of our parameterized URL value for Rails ActiveRecord to find the correct model instance. If we don’t want IDs to be presented in URLs at all, the friendly_id gem is a great choice for this.</p></li>
<li><p>How to install and use <a href="https://github.com/norman/friendly_id">friendly_id</a> in your rails project.</p></li>
<li>Here we also install <a href="https://github.com/norman/babosa">babosa</a> for multiple languages.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># add this to your Gemfile</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;friendly_id&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;babosa&#39;</span> <span class="c1"># this is for locale sensitive transliteration, with support for many languages.</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># in rails project</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>rails generate friendly_id
</span><span class='line'><span class="nv">$ </span>rails generate migration add_slug_to_models slug:string
</span><span class='line'><span class="nv">$ </span>rake db:migrate
</span><span class='line'>
</span><span class='line'><span class="c">#in rails console</span>
</span><span class='line'>
</span><span class='line'>If all have been already <span class="k">done</span>, we should run rails console and save all our model records again.
</span><span class='line'>&gt; Model.find_each<span class="o">(</span><span class="p">&amp;</span>:save<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h3>modify our rails model</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># edit app/models/model.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Model</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">FriendlyId</span>
</span><span class='line'>  <span class="n">friendly_id</span> <span class="ss">:column_name</span><span class="p">,</span> <span class="ss">use</span><span class="p">:</span> <span class="ss">:slugged</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># :history =&gt; won&#39;t change friendly id after updating :column_name</span>
</span><span class='line'>  <span class="c1"># :finder =&gt; no need to add .friendly method with Model anymore (gem&#39;s version should be above v5.0)</span>
</span><span class='line'>  <span class="c1"># use: [:slugged, :history, :finder]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># for genereate friendly_id</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">should_generate_new_friendly_id?</span>
</span><span class='line'>    <span class="n">new_record?</span> <span class="o">||</span> <span class="n">slug</span><span class="o">.</span><span class="n">blank?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># for locale sensitive transliteration with friendly_id</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">normalize_friendly_id</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
</span><span class='line'>    <span class="n">input</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">to_slug</span><span class="o">.</span><span class="n">normalize</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>reference
<a href="http://rubysnippets.com/2013/02/04/rails-seo-pretty-urls-in-rails/">http://rubysnippets.com/2013/02/04/rails-seo-pretty-urls-in-rails/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Use All View and Helper Methods in Rails Console]]></title>
    <link href="http://andystu.github.io/blog/2015/02/07/how-to-use-all-view-and-helper-methods-in-rails-console/"/>
    <updated>2015-02-07T00:56:39+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/07/how-to-use-all-view-and-helper-methods-in-rails-console</id>
    <content type="html"><![CDATA[<h3>run and preview a view helper</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;</span> <span class="no">YourController</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">my_helper</span>
</span><span class='line'>
</span><span class='line'><span class="o">&gt;</span> <span class="no">ApplicationController</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">content_tag</span><span class="p">(</span><span class="ss">:div</span><span class="p">,</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>create params in rails console</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># ActionController::Parameters.new</span>
</span><span class='line'><span class="n">params</span> <span class="o">=</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Parameters</span><span class="o">.</span><span class="n">new</span><span class="p">({</span>
</span><span class='line'>  <span class="ss">person</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Francesco&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">age</span><span class="p">:</span>  <span class="mi">22</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">role</span><span class="p">:</span> <span class="s1">&#39;admin&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>reference
<a href="http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html">http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Get a List of a Class or Instance Methods by Keyword]]></title>
    <link href="http://andystu.github.io/blog/2015/02/06/how-to-get-a-list-of-a-class-or-instance-methods-by-keyword/"/>
    <updated>2015-02-06T23:29:43+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/06/how-to-get-a-list-of-a-class-or-instance-methods-by-keyword</id>
    <content type="html"><![CDATA[<h4>a very useful tip to find methods in ruby/rails console</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Class.methods.grep(/keyword/) </span>
</span><span class='line'>
</span><span class='line'><span class="c1"># e.g. </span>
</span><span class='line'><span class="n">irb</span><span class="o">&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="sr">/to/</span><span class="p">)</span> <span class="c1">#  =&gt; [:to_s, :to_f, :to_default_s, :to_json, :upto, :downto, :to_i, :to_int, :numerator, :denominator, :to_r, :to_bn, :to_d, :singleton_method_added, :to_c, :to_formatted_s, :to_param, :to_query, :psych_to_yaml, :to_yaml, :to_yaml_properties, :singleton_class, :singleton_methods, :respond_to?, :singleton_method, :define_singleton_method, :to_enum]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Class.instance_methods.grep(/method/) #  =&gt; [:instance_methods, :public_instance_methods, :protected_instance_methods, :private_instance_methods, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Class.methods.grep(/new/) # =&gt; [&quot;new&quot;]</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Fix Octopress Build Warning Layout Nil Requested After Installing Some Themes]]></title>
    <link href="http://andystu.github.io/blog/2015/02/06/how-to-fix-octopress-build-warning-layout-nil-requested/"/>
    <updated>2015-02-06T14:17:39+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/06/how-to-fix-octopress-build-warning-layout-nil-requested</id>
    <content type="html"><![CDATA[<h4>How to fix Octopress &ldquo;build warning Layout nil requested&rdquo;</h4>

<p><code>
After changing some themes of octopress then rake generate might produce some errors like this:
Build Warning: Layout 'nil' requested in .....atom.xml does not exist.
</code></p>

<h4>Fix by replacing:</h4>

<p><code>layout: nil</code>
with:
<code>layout: null</code>
in files:
<code>
source/atom.xml
source/robots.txt
source/_includes/custom/category_feed.xml
</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ujs / Sjr Usage Hint]]></title>
    <link href="http://andystu.github.io/blog/2015/02/05/ujs-slash-sjr-usage-hint/"/>
    <updated>2015-02-05T10:52:25+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/05/ujs-slash-sjr-usage-hint</id>
    <content type="html"><![CDATA[<h3>ujs / sjr usage hint for rails link_to method and form!</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>A. Enable feature of ajax for Link
</span><span class='line'>  1. link_to 要加 remote: true, path 要是 .js 的 format
</span><span class='line'>  2. 要確保後端 action 支援 .js format
</span><span class='line'>  3. 必須要有 #{action}.js.erb
</span><span class='line'>
</span><span class='line'>B. Enable feature of ajax for Form
</span><span class='line'>  1. form_for(@record, format: :js, remote: true)
</span><span class='line'>  2. 確保後端 action 支援 .js format
</span><span class='line'>  3. 必須要有 #{action}.js.erb
</span><span class='line'>
</span><span class='line'>對應的 js.erb 必須處接下來的事情 e.g. 刪除資料、redirects、update forms ... etc</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bootstrap Tips: Some Resources for Bootstrap Customization]]></title>
    <link href="http://andystu.github.io/blog/2015/02/04/bootstrap-tips-some-resources-for-bootstrap-customization/"/>
    <updated>2015-02-04T10:48:54+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/04/bootstrap-tips-some-resources-for-bootstrap-customization</id>
    <content type="html"><![CDATA[<ul>
<li>useful online tools for generating bootstrap theme</li>
</ul>


<p><a href="http://pikock.github.io/bootstrap-magic/">http://pikock.github.io/bootstrap-magic/</a></p>

<p><a href="http://www.lavishbootstrap.com/">http://www.lavishbootstrap.com/</a></p>

<p><a href="http://paintstrap.com/">http://paintstrap.com/</a></p>

<p><a href="http://paintstrap.com/gallery/">http://paintstrap.com/gallery/</a></p>

<p><a href="http://bootswatchr.com/">http://bootswatchr.com/</a></p>

<p><a href="http://stylebootstrap.info/">http://stylebootstrap.info/</a></p>

<!--more-->


<ul>
<li>desktop tools</li>
</ul>


<p><a href="http://www.pingendo.com/">http://www.pingendo.com/</a></p>

<ul>
<li>layout tools</li>
</ul>


<p><a href="http://www.layoutit.com/">http://www.layoutit.com/</a></p>

<ul>
<li>useful plug-ins</li>
</ul>


<p><a href="http://vitalets.github.io/x-editable/">http://vitalets.github.io/x-editable/</a></p>

<p><a href="https://github.com/rorlab/bootstrap-tagsinput-rails">https://github.com/rorlab/bootstrap-tagsinput-rails</a></p>

<p><a href="http://timschlechter.github.io/bootstrap-tagsinput/examples/">http://timschlechter.github.io/bootstrap-tagsinput/examples/</a></p>

<ul>
<li>important reference</li>
</ul>


<p><a href="http://getbootstrap.com/customize/">http://getbootstrap.com/customize/</a></p>

<p><a href="http://mashable.com/2013/10/20/bootstrap-editors/">http://mashable.com/2013/10/20/bootstrap-editors/</a></p>

<p><a href="https://github.com/twbs/bootstrap-sass/tree/master/assets/stylesheets/bootstrap/mixins">https://github.com/twbs/bootstrap-sass/tree/master/assets/stylesheets/bootstrap/mixins</a></p>

<ul>
<li>convert tools</li>
</ul>


<p>gem &lsquo;less2sass&rsquo;
<a href="https://rubygems.org/gems/less2sass">https://rubygems.org/gems/less2sass</a></p>

<p>don&rsquo;t forget to add twbs-font-path on top or variable.sass file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// When true, asset path helpers are used, otherwise the regular CSS `url()` is used.
</span><span class='line'>// When there no function is defined, `fn('')` is parsed as string that equals the right hand side
</span><span class='line'>// NB: in Sass 3.3 there is a native function: function-exists(twbs-font-path)
</span><span class='line'>$bootstrap-sass-asset-helper: (twbs-font-path("") != unquote('twbs-font-path("")')) !default;</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Project Rake Tips]]></title>
    <link href="http://andystu.github.io/blog/2015/02/02/rails-project-rake-tips/"/>
    <updated>2015-02-02T22:50:20+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/02/rails-project-rake-tips</id>
    <content type="html"><![CDATA[<ul>
<li>Rails image disappears with error: Failed to load resource:</li>
<li>net::ERR_CONTENT_LENGTH_MISMATCH</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rake tmp:clear <span class="c"># for recompile asset tmp</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Console Tips: Table Operations]]></title>
    <link href="http://andystu.github.io/blog/2015/02/02/rails-console-tips-table-operations/"/>
    <updated>2015-02-02T18:04:19+08:00</updated>
    <id>http://andystu.github.io/blog/2015/02/02/rails-console-tips-table-operations</id>
    <content type="html"><![CDATA[<h2>In rails console, you can</h2>

<h3>list tables</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">tables</span>
</span></code></pre></td></tr></table></div></figure>


<h3>list a table structure (but it is a protected method)</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># this dose not work. </span>
</span><span class='line'><span class="o">&gt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">table_structure</span><span class="p">(</span><span class="s2">&quot;projects&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># we should utilize send method to call protected method</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@c</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@c</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="ss">:table_structure</span><span class="p">,</span> <span class="s2">&quot;xxxs&quot;</span><span class="p">)</span> <span class="c1"># xxxs is your model name</span>
</span></code></pre></td></tr></table></div></figure>


<h3>show table schema</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">columns</span> <span class="ss">:table_name</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Scaffold Create .erb Rather Thean .haml After Bundling Rails-haml Gem]]></title>
    <link href="http://andystu.github.io/blog/2015/01/20/rails-scaffold-create-erb-rather-thean-haml-after-bundling-rails-haml-gem/"/>
    <updated>2015-01-20T14:34:51+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/20/rails-scaffold-create-erb-rather-thean-haml-after-bundling-rails-haml-gem</id>
    <content type="html"><![CDATA[<ul>
<li>After bundling &lsquo;rails-haml&rsquo; gem, all views generated by scaffold are .haml. If we want to use default .erb views file, we need to append the folowing lines in your config/application.rb file or in config/enviroments/developement.rb.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># application.rb</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Events</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
</span><span class='line'><span class="c1"># append to here</span>
</span><span class='line'>    <span class="n">config</span><span class="o">.</span><span class="n">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
</span><span class='line'>       <span class="n">g</span><span class="o">.</span><span class="n">template_engine</span> <span class="ss">:erb</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<!--more-->


<p>or</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># developement.rb</span>
</span><span class='line'><span class="no">Events</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span>
</span><span class='line'><span class="c1"># Settings specified here will take precedence over those in config/application.rb.</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
</span><span class='line'>    <span class="n">g</span><span class="o">.</span><span class="n">template_engine</span> <span class="ss">:erb</span> <span class="c1"># or :haml if you prefer .haml</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
</span><span class='line'>  <span class="c1"># Raises error for missing translations</span>
</span><span class='line'>  <span class="c1"># config.action_view.raise_on_missing_translations = true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Make Jquery Event Work in Rails App?]]></title>
    <link href="http://andystu.github.io/blog/2015/01/19/how-to-make-jquery-event-work-in-rails-app/"/>
    <updated>2015-01-19T11:08:28+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/19/how-to-make-jquery-event-work-in-rails-app</id>
    <content type="html"><![CDATA[<ul>
<li><p>To make jquery event work, the easiest way is to use jquery.turbolinks.</p></li>
<li><p>To install it, just add this to your Gemfile:</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem 'jquery-turbolinks'
</span><span class='line'>
</span><span class='line'># and add this to your assets/javascripts/application.js file.
</span><span class='line'>
</span><span class='line'>//= require jquery.turbolinks
</span><span class='line'>
</span><span class='line'># and it should be worked good.</span></code></pre></td></tr></table></div></figure>


<h4>done.</h4>

<p><a href="http://stackoverflow.com/questions/17881384/jquery-gets-loaded-only-on-page-refresh-in-rails-4-application">http://stackoverflow.com/questions/17881384/jquery-gets-loaded-only-on-page-refresh-in-rails-4-application</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Upgrade Your Rails App?]]></title>
    <link href="http://andystu.github.io/blog/2015/01/19/how-to-upgrade-your-rails-app/"/>
    <updated>2015-01-19T10:50:23+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/19/how-to-upgrade-your-rails-app</id>
    <content type="html"><![CDATA[<ul>
<li>updating the Rails version in the Gemfile and run this rake task.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Gemfile
</span><span class='line'># Bundle edge Rails instead: gem 'rails', github: 'rails/rails'
</span><span class='line'>gem 'rails', '4.x.x' # &lt;- updating the version of rails info
</span><span class='line'>
</span><span class='line'>$ rake rails:update</span></code></pre></td></tr></table></div></figure>


<h4>done.</h4>

<p><a href="http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html">http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Generate Html Table From Array or Hash]]></title>
    <link href="http://andystu.github.io/blog/2015/01/14/generate-html-table-from-array-or-hash/"/>
    <updated>2015-01-14T16:24:34+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/14/generate-html-table-from-array-or-hash</id>
    <content type="html"><![CDATA[<ul>
<li>install gem builder</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gem install builder</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Use Builder for generate HTML table</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Use the XMLBuilder for this:</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;builder&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">data</span> <span class="o">=</span> <span class="o">[</span><span class="p">{</span><span class="s2">&quot;col1&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;v2&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;col1&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;v4&quot;</span><span class="p">}</span><span class="o">]</span>
</span><span class='line'><span class="n">xm</span> <span class="o">=</span> <span class="no">Builder</span><span class="o">::</span><span class="no">XmlMarkup</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:indent</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="n">xm</span><span class="o">.</span><span class="n">table</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">xm</span><span class="o">.</span><span class="n">tr</span> <span class="p">{</span> <span class="n">data</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">keys</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">key</span><span class="o">|</span> <span class="n">xm</span><span class="o">.</span><span class="n">th</span><span class="p">(</span><span class="n">key</span><span class="p">)}}</span>
</span><span class='line'>  <span class="n">data</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="n">xm</span><span class="o">.</span><span class="n">tr</span> <span class="p">{</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">value</span><span class="o">|</span> <span class="n">xm</span><span class="o">.</span><span class="n">td</span><span class="p">(</span><span class="n">value</span><span class="p">)}}}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">xm</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<!--more-->


<ul>
<li>Output</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>col1<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>col2<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>v1<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>v2<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>v3<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>v4<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>done.</h4>

<p><a href="http://stackoverflow.com/questions/2634024/generate-an-html-table-from-an-array-of-hashes-in-ruby">http://stackoverflow.com/questions/2634024/generate-an-html-table-from-an-array-of-hashes-in-ruby</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Object to Hash]]></title>
    <link href="http://andystu.github.io/blog/2015/01/14/rails-object-to-hash/"/>
    <updated>2015-01-14T12:26:38+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/14/rails-object-to-hash</id>
    <content type="html"><![CDATA[<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">c</span>
</span><span class='line'><span class="c1"># irb</span>
</span><span class='line'><span class="c1"># Model object -&gt; hash</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@post</span><span class="o">.</span><span class="n">attributes</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># OpenStruct object -&gt; hash</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@post</span> <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">title</span><span class="p">:</span><span class="s2">&quot;this is title&quot;</span><span class="p">,</span> <span class="ss">description</span><span class="p">:</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;</span> <span class="vi">@post</span><span class="o">.</span><span class="n">to_h</span>
</span><span class='line'><span class="c1"># equals to -&gt; ActionController::Parameters.new(@p.to_h)</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Use Command Line Show Git Tree]]></title>
    <link href="http://andystu.github.io/blog/2015/01/13/how-to-use-command-line-show-git-tree/"/>
    <updated>2015-01-13T18:11:36+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/13/how-to-use-command-line-show-git-tree</id>
    <content type="html"><![CDATA[<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git log --pretty<span class="o">=</span>oneline --graph --decorate --all
</span><span class='line'><span class="nv">$ </span>git log --oneline --graph --decorate --all
</span><span class='line'><span class="nv">$ </span>gitk --simplify-by-decoration --all
</span><span class='line'><span class="nv">$ </span>gitk --all
</span><span class='line'><span class="nv">$ </span>git show-branch --all
</span><span class='line'><span class="nv">$ </span>git log --all --graph --decorate --oneline --simplify-by-decoration
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dynamic Form Implementing Note]]></title>
    <link href="http://andystu.github.io/blog/2015/01/13/my-dynamic-form-implementing-note/"/>
    <updated>2015-01-13T14:40:41+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/13/my-dynamic-form-implementing-note</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rails g scaffold product name price:decimal
</span><span class='line'>$ rails g scaffold product_type name
</span><span class='line'>$ rails g scaffold product_field name field_type required:boolean product_type:belongs_to
</span><span class='line'>$ rails g migration add_type_to_product product_type:belongs_to properties:text
</span><span class='line'>$ rake db:migrate</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># config/routes.rb</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>  <span class="n">resources</span> <span class="ss">:product_types</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">resources</span> <span class="ss">:products</span>
</span><span class='line'>  <span class="n">root</span> <span class="s1">&#39;products#index&#39;</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<!--more-->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="err">#</span> <span class="nx">assets</span><span class="o">/</span><span class="nx">javascripts</span><span class="o">/</span><span class="nx">product_types</span><span class="p">.</span><span class="nx">js</span><span class="p">.</span><span class="nx">coffee</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;form .remove_fields&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">prev</span><span class="p">(</span><span class="s1">&#39;input[type=hidden]&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;fieldset&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
</span><span class='line'>  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;form .add_fields&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">time</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span>
</span><span class='line'>  <span class="nx">regexp</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">regexp</span><span class="p">,</span> <span class="nx">time</span><span class="p">))</span>
</span><span class='line'>  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># models/product.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:product_type</span>
</span><span class='line'>  <span class="n">serialize</span> <span class="ss">:properties</span><span class="p">,</span> <span class="no">Hash</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">validate_properties</span>
</span><span class='line'>    <span class="n">product_type</span><span class="o">.</span><span class="n">product_fields</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">field</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">required?</span> <span class="o">&amp;&amp;</span> <span class="n">properties</span><span class="o">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="o">].</span><span class="n">blank?</span>
</span><span class='line'>        <span class="n">errors</span><span class="o">.</span><span class="n">add</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;must not be blank&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># models/product_type.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">ProductType</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:fields</span><span class="p">,</span> <span class="ss">class_name</span><span class="p">:</span> <span class="s1">&#39;ProductField&#39;</span>
</span><span class='line'>  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:fields</span><span class="p">,</span> <span class="ss">allow_destroy</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="c1">#  has_many :product_fields</span>
</span><span class='line'><span class="c1">#  accepts_nested_attributes_for :product_fields, allow_destroy: true</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># models/product_field.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">ProductField</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:product_type</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># product_types_controller.rb </span>
</span><span class='line'><span class="c1"># product_types_params should be modified for its nested attributes</span>
</span><span class='line'><span class="k">def</span> <span class="nf">product_type_params</span>
</span><span class='line'>  <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:product_type</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">fields_attributes</span><span class="p">:</span> <span class="o">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:field_type</span><span class="p">,</span> <span class="ss">:required</span><span class="p">,</span> <span class="ss">:product_type_id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># products_controller.rb </span>
</span><span class='line'><span class="c1"># product_params need to be modified for its column properties</span>
</span><span class='line'><span class="k">def</span> <span class="nf">product_params</span>
</span><span class='line'>  <span class="c1"># all_properties = params.require(:product).fetch(:properties)</span>
</span><span class='line'>  <span class="c1"># params.require(:product).permit(:name, :price, :product_type_id, :properties).merge(:properties =&gt; all_properties)</span>
</span><span class='line'>  <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:product</span><span class="p">)</span><span class="o">.</span><span class="n">permit!</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># products_controller.rb </span>
</span><span class='line'><span class="c1"># for generating dynamic form, action new also need to pass its product_type_id to view.</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">new</span>
</span><span class='line'>    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">product_type_id</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:product_type_id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># application_helper.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">ApplicationHelper</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">link_to_add_fields</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">association</span><span class="p">)</span>
</span><span class='line'>    <span class="n">new_object</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">association</span><span class="p">)</span><span class="o">.</span><span class="n">klass</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="nb">id</span> <span class="o">=</span> <span class="n">new_object</span><span class="o">.</span><span class="n">object_id</span>
</span><span class='line'>    <span class="n">fields</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fields_for</span><span class="p">(</span><span class="n">association</span><span class="p">,</span> <span class="n">new_object</span><span class="p">,</span> <span class="ss">child_index</span><span class="p">:</span> <span class="nb">id</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">builder</span><span class="o">|</span>
</span><span class='line'>      <span class="n">render</span><span class="p">(</span><span class="n">association</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">singularize</span> <span class="o">+</span> <span class="s2">&quot;_fields&quot;</span><span class="p">,</span> <span class="ss">f</span><span class="p">:</span> <span class="n">builder</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">link_to</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;add_fields&quot;</span><span class="p">,</span> <span class="ss">data</span><span class="p">:</span> <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="ss">fields</span><span class="p">:</span> <span class="n">fields</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)})</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># product_types/_form.html.erb</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">%= form_for(@product_type) do |f| %&gt;</span>
</span><span class='line'><span class="sx">  ...</span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :name %&gt;&lt;br&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= f.fields_for :fields do |builder| %&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">render</span> <span class="s2">&quot;field_fields&quot;</span><span class="p">,</span> <span class="ss">f</span><span class="p">:</span> <span class="n">builder</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;% end %&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= link_to_add_fields &quot;Add Field&quot;, f, :fields %&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;actions&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.submit %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="sx">&lt;% end %&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx"># add product_types/_product_field_fields.html.erb</span>
</span><span class='line'><span class="sx">&lt;fieldset&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">select</span> <span class="ss">:field_type</span><span class="p">,</span> <span class="sx">%w[text_field check_box shirt_sizes]</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;%= f.text_field :name, placeholder: &quot;field_name&quot; %&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= f.check_box :required %&gt; &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:required</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;%= f.hidden_field :_destroy %&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= link_to &quot;remove&quot;, &#39;#&#39;, class: &quot;remove_fields&quot; %&gt;</span>
</span><span class='line'><span class="sx">&lt;/fieldset&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx"># product_types/show.html.erb</span>
</span><span class='line'><span class="sx">&lt;p id=</span><span class="s2">&quot;notice&quot;</span><span class="o">&gt;&lt;</span><span class="sx">%= notice %&gt;&lt;/p&gt;</span>
</span><span class='line'><span class="sx">&lt;p&gt;</span>
</span><span class='line'><span class="sx">  &lt;strong&gt;Name:&lt;/strong&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=</span> <span class="vi">@product_type</span><span class="o">.</span><span class="n">name</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/p&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="ss">Fields</span><span class="p">:</span><span class="o">&lt;</span><span class="sr">/strong&gt;</span>
</span><span class='line'><span class="sr">  &lt;%= @product_type.fields.each do |f| %&gt;</span>
</span><span class='line'><span class="sr">  &lt;br&gt;</span>
</span><span class='line'><span class="sr">  &lt;%= f.name %&gt;</span>
</span><span class='line'><span class="sr">  &lt;br&gt;</span>
</span><span class='line'><span class="sr">  &lt;%= f.field_type %&gt;</span>
</span><span class='line'><span class="sr">  &lt;% end -%&gt;</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># products/_form.html.erb</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :price %&gt;&lt;br&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:price</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= f.fields_for :properties, OpenStruct.new(@product.properties) do |builder| %&gt;</span>
</span><span class='line'><span class="sx">    &lt;% @product.product_type.fields.each do |field| %&gt;</span>
</span><span class='line'><span class="sx">      &lt;%=</span> <span class="n">render</span> <span class="s2">&quot;products/fields/</span><span class="si">#{</span><span class="n">field</span><span class="o">.</span><span class="n">field_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ss">field</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span> <span class="ss">f</span><span class="p">:</span> <span class="n">builder</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">    &lt;% end %&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">% end %&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;div class=&quot;actions&quot;&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.submit %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="sx">&lt;% end %&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx"># products/index.html.erb</span>
</span><span class='line'><span class="sx">...</span>
</span><span class='line'><span class="sx">&lt;%=</span> <span class="n">form_tag</span> <span class="n">new_product_path</span><span class="p">,</span> <span class="nb">method</span><span class="p">:</span> <span class="ss">:get</span> <span class="k">do</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;%= select_tag :product_type_id, options_from_collection_for_select(ProductType.all, :id, :name) %&gt;</span>
</span><span class='line'>  <span class="o">&lt;%=</span> <span class="n">submit_tag</span> <span class="s2">&quot;New Product&quot;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="kp">nil</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;% end %&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>tips: OpenStruct.new(@product.properties)</h3>

<p><em>Without OpenStruct.new object, we can&rsquo;t edit and update hash properties data of the record.</em></p>

<h4>done.</h4>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Change Default Web Server and Timezone for Heroku]]></title>
    <link href="http://andystu.github.io/blog/2015/01/09/change-default-web-server-and-timezone-for-heroku/"/>
    <updated>2015-01-09T12:17:25+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/09/change-default-web-server-and-timezone-for-heroku</id>
    <content type="html"><![CDATA[<ul>
<li>add web server gem to your Gemfile</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:production</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;pg&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;rails_12factor&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;thin&#39;</span> <span class="c1"># web server : thin</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>bundle it for updating your Gemfile.lock</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle install
</span><span class='line'><span class="nv">$ </span>git add .
</span><span class='line'><span class="nv">$ </span>git commit -am <span class="s1">&#39;bundle and update Gemfile.lock&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>deploy to heroku</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git push heroku master
</span></code></pre></td></tr></table></div></figure>


<h4>done.</h4>

<ul>
<li>time zone config for heroku</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>heroku config:add <span class="nv">TZ</span><span class="o">=</span>Asia/Taipei
</span></code></pre></td></tr></table></div></figure>


<h4>done.</h4>

<ul>
<li>for reset pg DB</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>heroku pg:reset DATABASE_URL --confirm heroku_app_name
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Tips: User Authentication Using Devise]]></title>
    <link href="http://andystu.github.io/blog/2015/01/08/rails-tips-user-authentication-using-devise/"/>
    <updated>2015-01-08T11:04:33+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/08/rails-tips-user-authentication-using-devise</id>
    <content type="html"><![CDATA[<ul>
<li>create a demo project by rails</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="kp">new</span> <span class="n">topic</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>add gem &lsquo;devise&rsquo; to Gemfile then bundle it.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Gemfile</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;devise&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="err">$</span> <span class="n">bundle</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>install into your project, generate user model and views</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">generate</span> <span class="ss">devise</span><span class="p">:</span><span class="n">install</span>
</span><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">generate</span> <span class="n">devise</span> <span class="no">User</span>
</span><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">generate</span> <span class="ss">devise</span><span class="p">:</span><span class="n">views</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>configure development.rb for action mailer setting</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">host</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="ss">port</span><span class="p">:</span> <span class="mi">3000</span> <span class="p">}</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">delivery_method</span> <span class="o">=</span> <span class="ss">:smtp</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>configure application.rb for action mailer setting</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">ActionMailer</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">smtp_settings</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="ss">:address</span>        <span class="o">=&gt;</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:domain</span>         <span class="o">=&gt;</span> <span class="s1">&#39;mail.google.com&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:port</span>           <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:user_name</span>      <span class="o">=&gt;</span> <span class="s2">&quot;your_gmail_account@gmail.com&quot;</span><span class="p">,</span> <span class="c1">#ENV[&#39;GMAIL_USERNAME&#39;],</span>
</span><span class='line'>        <span class="ss">:password</span>       <span class="o">=&gt;</span> <span class="s2">&quot;weakpass&quot;</span><span class="p">,</span> <span class="c1">#ENV[&#39;GMAIL_PASSWORD&#39;],</span>
</span><span class='line'>        <span class="ss">:authentication</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:enable_starttls_auto</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>generate a scaffold for the topic resource and add registrations controller for overriding devise&rsquo;s one</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">scaffold</span> <span class="n">topic</span> <span class="n">title</span>
</span><span class='line'><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">registrations</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># in registrations_controller.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">RegistrationsController</span> <span class="o">&lt;</span> <span class="no">Devise</span><span class="o">::</span><span class="no">RegistrationsController</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sign_up_params</span>
</span><span class='line'>    <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">:password_confirmation</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">account_update_params</span>
</span><span class='line'>    <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="ss">:current_password</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># modify route.rb</span>
</span><span class='line'><span class="n">devise_for</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">controllers</span><span class="p">:</span> <span class="p">{</span> <span class="ss">registrations</span><span class="p">:</span> <span class="s2">&quot;registrations&quot;</span> <span class="p">}</span>
</span><span class='line'><span class="n">root</span> <span class="s1">&#39;topics#index&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># add the following &quot;before_action&quot; to topics_conftroller.rb for forcing users logging in</span>
</span><span class='line'><span class="n">before_action</span> <span class="ss">:authenticate_user!</span>
</span></code></pre></td></tr></table></div></figure>


<h5>done and enjoy it.</h5>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails App Deploy to Heroku : An Easy Way]]></title>
    <link href="http://andystu.github.io/blog/2015/01/06/rails-app-deploy-to-heroku-simple-how-to/"/>
    <updated>2015-01-06T23:24:04+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/06/rails-app-deploy-to-heroku-simple-how-to</id>
    <content type="html"><![CDATA[<h3>Preparing step</h3>

<ul>
<li>install Postgres DB via brew</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>brew doctor
</span><span class='line'><span class="nv">$ </span>brew update
</span><span class='line'><span class="nv">$ </span>brew install postgresql
</span><span class='line'>
</span><span class='line'><span class="c"># if we want to run pg locally, we need to run the following instructions.</span>
</span><span class='line'>
</span><span class='line'><span class="c"># To have launchd start postgresql at login:</span>
</span><span class='line'>ln -sfv /usr/local/opt/postgresql/*plist ~/Library/LaunchAgents
</span><span class='line'>
</span><span class='line'><span class="c"># Then to load and run postgresql immediately:</span>
</span><span class='line'>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>download and install heroku toolkit<br/>
<a href="https://toolbelt.heroku.com/">https://toolbelt.heroku.com/</a></li>
<li>initialization of heroku under your rails project</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>heroku login
</span><span class='line'><span class="nv">$ </span>heroku create
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Open the file called Gemfile in your text editor and find the line containing:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;sqlite3&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Remove that line and replace it with:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:development</span><span class="p">,</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;sqlite3&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">group</span> <span class="ss">:production</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;pg&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;rails_12factor&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>bundle install</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span> <span class="n">install</span> <span class="o">--</span><span class="n">without</span> <span class="n">production</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>git add . and git commit</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git add .
</span><span class='line'><span class="nv">$ </span>git commit -m <span class="s2">&quot;Changed Gemfile for heroku&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>finally, push to heroku</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git push heroku master
</span><span class='line'><span class="nv">$ </span>heroku run rake db:migrate
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails Tips: Rails G Scaffold for Reference Field]]></title>
    <link href="http://andystu.github.io/blog/2015/01/03/rails-tips-rails-g-scaffold-for-reference-field/"/>
    <updated>2015-01-03T11:02:27+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/03/rails-tips-rails-g-scaffold-for-reference-field</id>
    <content type="html"><![CDATA[<p>Rails scaffold generators are very smart! you can use belongs_to to quickly add relations.
In the following example, I have 2 models products and product_types;
Product_types belong to product and product has many product types.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails g scaffold product name:string
</span><span class='line'><span class="nv">$ </span>rails g scaffold product_type name:string product:belongs_to
</span><span class='line'>
</span><span class='line'><span class="c"># You can also use :references</span>
</span><span class='line'><span class="nv">$ </span>rails g scaffold product_type name:string product:references
</span><span class='line'>
</span><span class='line'><span class="c"># For more manually work, you can do it like this</span>
</span><span class='line'><span class="nv">$ </span>rails g scaffold product_type name:string product_id:integer
</span><span class='line'><span class="c"># then add &quot;belongs_to&quot; in your ProductType model</span>
</span></code></pre></td></tr></table></div></figure>


<p>This will generate the necessary columns, indexes and associations in your models.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RubyGems: Why Simple_form?]]></title>
    <link href="http://andystu.github.io/blog/2015/01/03/rubygems-why-simple-form/"/>
    <updated>2015-01-03T00:45:32+08:00</updated>
    <id>http://andystu.github.io/blog/2015/01/03/rubygems-why-simple-form</id>
    <content type="html"><![CDATA[<h3>why use simple_form</h3>

<ol>
<li>Required fields are marked with an * prepended to their labels.</li>
<li>Simple Form also lets you overwrite the default input type it creates:</li>
<li>You can overwrite the default label by passing it to the input method. You can also add a hint or even a placeholder. For boolean inputs, you can add an inline label as well.</li>
<li>It is also possible to pass any html attribute straight to the input, by using the :input_html option.</li>
</ol>


<h4>[reference]</h4>

<p><a href="https://github.com/plataformatec/simple_form">https://github.com/plataformatec/simple_form</a></p>
]]></content>
  </entry>
  
</feed>
